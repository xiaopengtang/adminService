(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{IaVo:function(e,t,a){e.exports={tableList:"antd-pro-pages-resource-list-tableList",tableListOperator:"antd-pro-pages-resource-list-tableListOperator",tableListForm:"antd-pro-pages-resource-list-tableListForm",submitButtons:"antd-pro-pages-resource-list-submitButtons"}},SfvP:function(e,t,a){"use strict";var l=a("4Gf+"),d=a("GyWo");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("U7p0");var r=l(a("pXLU"));a("t0lF");var s=l(a("kDCt"));a("BrD1");var u=l(a("SpN2"));a("YvrW");var n=l(a("uG6z"));a("T7DU");var i=l(a("/72G"));a("X5VD");var o=l(a("bA53"));a("ZkGU");var f=l(a("zOAu"));a("I9VT");var c=l(a("OsYg"));a("Xe2/");var m=l(a("PRXz")),p=l(a("RSNA")),h=l(a("OjS7"));a("K1xq");var E=l(a("lmRu"));a("Odsp");var y=l(a("0LJ2"));a("Ljnx");var b=l(a("EfNK"));a("baa/");var v=l(a("6wzi"));a("VfK5");var g=l(a("LcI5"));a("9RKC");var k=l(a("6RLy"));a("1EyM");var w=l(a("VEhp"));a("ZDDI");var V=l(a("XjAy"));a("K5T9");var C,F,S,L,D,M=l(a("xn9m")),x=d(a("4G06")),I=a("LneV"),R=(l(a("I9Uw")),a("HZnN"),l(a("CkN6"))),O=l(a("zHco")),U=l(a("FepY")),A=l(a("IaVo")),N=M.default.Item,q=V.default.Step,T=w.default.TextArea,j=k.default.Option,z=g.default.Group,G=e=>Object.keys(e).map(t=>e[t]).join(","),Y=null,B=M.default.create()(e=>{var t=e.modalVisible,a=e.form,l=e.handleAdd,d=e.handleModalVisible,r=e.updateInfo;console.log({updateInfo:r});var s=()=>{a.validateFields((e,t)=>{e||(r&&(t.id=r.id,Y=Y||r&&r.image),t.image=Y,a.resetFields(),l(t),Y=null)})},u={name:"file",action:"http://47.99.166.177:8360/upload?uid=10000",onChange(e){if("done"===e.file.status){var t=e.file.response.data;t.forEach(e=>{Y=e.id})}}};return r=r||{},x.default.createElement(E.default,{destroyOnClose:!0,title:r.id?"\u4fee\u6539\u83dc\u5355":"\u65b0\u5efa\u83dc\u5355",visible:t,onOk:s,onCancel:()=>d()},x.default.createElement(N,{labelCol:{span:5},wrapperCol:{span:15},label:"\u83dc\u5355\u540d"},a.getFieldDecorator("name",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u83dc\u5355\u540d"}],initialValue:r.name})(x.default.createElement(w.default,{placeholder:"\u8bf7\u8f93\u5165"}))),x.default.createElement(N,{labelCol:{span:5},wrapperCol:{span:15},label:"\u5e8f\u5217"},a.getFieldDecorator("sort",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u83dc\u5355\u540d"}],initialValue:r.sort})(x.default.createElement(w.default,{type:"number",placeholder:"\u8bf7\u8f93\u5165"}))),x.default.createElement(N,{labelCol:{span:5},wrapperCol:{span:15},label:"url"},a.getFieldDecorator("url",{rules:[{required:!0,message:"\u8bf7\u586b\u5199url"}],initialValue:r.url})(x.default.createElement(w.default,{placeholder:"\u8bf7\u8f93\u5165"}))),x.default.createElement(N,{labelCol:{span:5},wrapperCol:{span:15},label:"\u56fe\u7247\u4e0a\u4f20"},x.default.createElement(y.default,u,x.default.createElement(b.default,null,x.default.createElement(v.default,{type:"upload"}),"\u4e0a\u4f20"))))}),K=(C=M.default.create(),C(F=class extends x.PureComponent{constructor(e){super(e),this.handleNext=(e=>{var t=this.props,a=t.form,l=t.handleUpdate,d=this.state.formVals;a.validateFields((t,a)=>{if(!t){var r=(0,h.default)({},d,a);this.setState({formVals:r},()=>{e<2?this.forward():l(r)})}})}),this.backward=(()=>{var e=this.state.currentStep;this.setState({currentStep:e-1})}),this.forward=(()=>{var e=this.state.currentStep;this.setState({currentStep:e+1})}),this.renderContent=((e,t)=>{var a=this.props.form;return 1===e?[x.default.createElement(N,(0,p.default)({key:"target"},this.formLayout,{label:"\u76d1\u63a7\u5bf9\u8c61"}),a.getFieldDecorator("target",{initialValue:t.target})(x.default.createElement(k.default,{style:{width:"100%"}},x.default.createElement(j,{value:"0"},"\u8868\u4e00"),x.default.createElement(j,{value:"1"},"\u8868\u4e8c")))),x.default.createElement(N,(0,p.default)({key:"template"},this.formLayout,{label:"\u89c4\u5219\u6a21\u677f"}),a.getFieldDecorator("template",{initialValue:t.template})(x.default.createElement(k.default,{style:{width:"100%"}},x.default.createElement(j,{value:"0"},"\u89c4\u5219\u6a21\u677f\u4e00"),x.default.createElement(j,{value:"1"},"\u89c4\u5219\u6a21\u677f\u4e8c")))),x.default.createElement(N,(0,p.default)({key:"type"},this.formLayout,{label:"\u89c4\u5219\u7c7b\u578b"}),a.getFieldDecorator("type",{initialValue:t.type})(x.default.createElement(z,null,x.default.createElement(g.default,{value:"0"},"\u5f3a"),x.default.createElement(g.default,{value:"1"},"\u5f31"))))]:2===e?[x.default.createElement(N,(0,p.default)({key:"time"},this.formLayout,{label:"\u5f00\u59cb\u65f6\u95f4"}),a.getFieldDecorator("time",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5f00\u59cb\u65f6\u95f4\uff01"}]})(x.default.createElement(m.default,{style:{width:"100%"},showTime:!0,format:"YYYY-MM-DD HH:mm:ss",placeholder:"\u9009\u62e9\u5f00\u59cb\u65f6\u95f4"}))),x.default.createElement(N,(0,p.default)({key:"frequency"},this.formLayout,{label:"\u8c03\u5ea6\u5468\u671f"}),a.getFieldDecorator("frequency",{initialValue:t.frequency})(x.default.createElement(k.default,{style:{width:"100%"}},x.default.createElement(j,{value:"month"},"\u6708"),x.default.createElement(j,{value:"week"},"\u5468"))))]:[x.default.createElement(N,(0,p.default)({key:"name"},this.formLayout,{label:"\u89c4\u5219\u540d\u79f0"}),a.getFieldDecorator("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0\uff01"}],initialValue:t.name})(x.default.createElement(w.default,{placeholder:"\u8bf7\u8f93\u5165"}))),x.default.createElement(N,(0,p.default)({key:"desc"},this.formLayout,{label:"\u89c4\u5219\u63cf\u8ff0"}),a.getFieldDecorator("desc",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\u7684\u89c4\u5219\u63cf\u8ff0\uff01",min:5}],initialValue:t.desc})(x.default.createElement(T,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"})))]}),this.renderFooter=(e=>{var t=this.props.handleUpdateModalVisible;return 1===e?[x.default.createElement(b.default,{key:"back",style:{float:"left"},onClick:this.backward},"\u4e0a\u4e00\u6b65"),x.default.createElement(b.default,{key:"cancel",onClick:()=>t()},"\u53d6\u6d88"),x.default.createElement(b.default,{key:"forward",type:"primary",onClick:()=>this.handleNext(e)},"\u4e0b\u4e00\u6b65")]:2===e?[x.default.createElement(b.default,{key:"back",style:{float:"left"},onClick:this.backward},"\u4e0a\u4e00\u6b65"),x.default.createElement(b.default,{key:"cancel",onClick:()=>t()},"\u53d6\u6d88"),x.default.createElement(b.default,{key:"submit",type:"primary",onClick:()=>this.handleNext(e)},"\u5b8c\u6210")]:[x.default.createElement(b.default,{key:"cancel",onClick:()=>t()},"\u53d6\u6d88"),x.default.createElement(b.default,{key:"forward",type:"primary",onClick:()=>this.handleNext(e)},"\u4e0b\u4e00\u6b65")]}),this.state={formVals:{name:e.values.name,desc:e.values.desc,key:e.values.key,target:"0",template:"0",type:"1",time:"",frequency:"month"},updateInfo:{},currentStep:0},this.formLayout={labelCol:{span:7},wrapperCol:{span:13}}}render(){var e=this.props,t=e.updateModalVisible,a=e.handleUpdateModalVisible,l=this.state,d=l.currentStep,r=l.formVals;return x.default.createElement(E.default,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u89c4\u5219\u914d\u7f6e",visible:t,footer:this.renderFooter(d),onCancel:()=>a()},x.default.createElement(V.default,{style:{marginBottom:28},size:"small",current:d},x.default.createElement(q,{title:"\u57fa\u672c\u4fe1\u606f"}),x.default.createElement(q,{title:"\u914d\u7f6e\u89c4\u5219\u5c5e\u6027"}),x.default.createElement(q,{title:"\u8bbe\u5b9a\u8c03\u5ea6\u5468\u671f"})),this.renderContent(d,r))}})||F),P=(S=(0,I.connect)(e=>{var t=e.news,a=e.loading;return{news:t,loading:a.models.news}}),L=M.default.create(),S(D=L(D=class extends x.PureComponent{constructor(){super(...arguments),this.state={modalVisible:!1,updateModalVisible:!1,expandForm:!1,selectedRows:[],formValues:{},stepFormValues:{}},this.columns=[{title:"ID",dataIndex:"id"},{title:"\u6807\u9898",dataIndex:"title"},{title:"\u6dfb\u52a0\u65f6\u95f4",dataIndex:"pubTime",sorter:!0,needTotal:!0},{title:"\u64cd\u4f5c",render:(e,t)=>x.default.createElement(x.Fragment,null,x.default.createElement("a",{onClick:()=>this.handleDelModalVisible(!0,t)},"\u5220\u9664"),x.default.createElement(c.default,{type:"vertical"}),x.default.createElement("a",{onClick:()=>this.handleUpdateModalVisible(t)},"\u4fee\u6539"))}],this.handleStandardTableChange=((e,t,a)=>{var l=this.props.dispatch,d=this.state.formValues,r=Object.keys(t).reduce((e,a)=>{var l=(0,h.default)({},e);return l[a]=G(t[a]),l},{}),s=(0,h.default)({currentPage:e.current,pageSize:e.pageSize},d,r);a.field&&(s.sorter=`${a.field}_${a.order}`),l({type:"news/getList",payload:s})}),this.handleFormReset=(()=>{var e=this.props,t=e.form,a=e.dispatch;t.resetFields(),this.setState({formValues:{}}),a({type:"news/getList",payload:{}})}),this.toggleForm=(()=>{var e=this.state.expandForm;this.setState({expandForm:!e})}),this.handleMenuClick=(e=>{var t=this.props.dispatch,a=this.state.selectedRows;if(a)switch(e.key){case"remove":t({type:"rule/remove",payload:{key:a.map(e=>e.key)},callback:()=>{this.setState({selectedRows:[]})}});break;default:break}}),this.handleSelectRows=(e=>{this.setState({selectedRows:e})}),this.handleSearch=(e=>{e.preventDefault();var t=this.props,a=t.dispatch,l=t.form;l.validateFields((e,t)=>{if(!e){var l=(0,h.default)({},t,{updatedAt:t.updatedAt&&t.updatedAt.valueOf()});this.setState({formValues:l}),a({type:"news/getList",payload:l})}})}),this.handleModalVisible=(e=>{this.setState({modalVisible:!!e,updateInfo:null})}),this.handleDelModalVisible=((e,t)=>{var a=this.props.dispatch;a({type:"news/del",payload:{id:t.id}}).then(e=>{f.default.success("\u5220\u9664\u6210\u529f"),this.reload()}).catch(e=>f.default.error("\u5220\u9664\u5931\u8d25"))}),this.handleAdd=(e=>{var t=this.props.dispatch;t({type:e.id?"news/update":"news/add",payload:e}).then(e=>{f.default.success("\u64cd\u4f5c\u6210\u529f"),this.reload(),this.handleModalVisible()}).catch(e=>f.default.error("\u64cd\u4f5c\u5931\u8d25"))}),this.handleUpdate=(e=>{var t=this.props.dispatch;t({type:"rule/update",payload:{name:e.name,desc:e.desc,key:e.key}}),f.default.success("\u914d\u7f6e\u6210\u529f"),this.handleUpdateModalVisible()})}componentDidMount(){var e=this.props.dispatch;e({type:"news/getList"})}handleUpdateModalVisible(e){this.setState({modalVisible:!0,updateInfo:e})}reload(){var e=this.props.dispatch;e({type:"news/getList",payload:{}})}renderSimpleForm(){var e=this.props.form.getFieldDecorator;return x.default.createElement(M.default,{onSubmit:this.handleSearch,layout:"inline"},x.default.createElement(i.default,{gutter:{md:8,lg:24,xl:48}},x.default.createElement(o.default,{md:8,sm:24},x.default.createElement(N,{label:"\u6807\u9898"},e("name")(x.default.createElement(w.default,{placeholder:"\u8bf7\u8f93\u5165"})))),x.default.createElement(o.default,{md:8,sm:24},x.default.createElement(N,{label:"\u72b6\u6001"},e("status")(x.default.createElement(k.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},x.default.createElement(j,{value:"0"},"\u5173\u95ed"),x.default.createElement(j,{value:"1"},"\u8fd0\u884c\u4e2d"))))),x.default.createElement(o.default,{md:6,sm:24},x.default.createElement("span",{className:A.default.submitButtons},x.default.createElement(b.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),x.default.createElement(b.default,{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e")))))}renderAdvancedForm(){var e=this.props.form.getFieldDecorator;return x.default.createElement(M.default,{onSubmit:this.handleSearch,layout:"inline"},x.default.createElement(i.default,{gutter:{md:8,lg:24,xl:48}},x.default.createElement(o.default,{md:8,sm:24},x.default.createElement(N,{label:"\u89c4\u5219\u540d\u79f0"},e("name")(x.default.createElement(w.default,{placeholder:"\u8bf7\u8f93\u5165"})))),x.default.createElement(o.default,{md:8,sm:24},x.default.createElement(N,{label:"\u4f7f\u7528\u72b6\u6001"},e("status")(x.default.createElement(k.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},x.default.createElement(j,{value:"0"},"\u5173\u95ed"),x.default.createElement(j,{value:"1"},"\u8fd0\u884c\u4e2d"))))),x.default.createElement(o.default,{md:8,sm:24},x.default.createElement(N,{label:"\u8c03\u7528\u6b21\u6570"},e("number")(x.default.createElement(n.default,{style:{width:"100%"}}))))),x.default.createElement(i.default,{gutter:{md:8,lg:24,xl:48}},x.default.createElement(o.default,{md:8,sm:24},x.default.createElement(N,{label:"\u66f4\u65b0\u65e5\u671f"},e("date")(x.default.createElement(m.default,{style:{width:"100%"},placeholder:"\u8bf7\u8f93\u5165\u66f4\u65b0\u65e5\u671f"})))),x.default.createElement(o.default,{md:8,sm:24},x.default.createElement(N,{label:"\u4f7f\u7528\u72b6\u6001"},e("status3")(x.default.createElement(k.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},x.default.createElement(j,{value:"0"},"\u5173\u95ed"),x.default.createElement(j,{value:"1"},"\u8fd0\u884c\u4e2d"))))),x.default.createElement(o.default,{md:8,sm:24},x.default.createElement(N,{label:"\u4f7f\u7528\u72b6\u6001"},e("status4")(x.default.createElement(k.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},x.default.createElement(j,{value:"0"},"\u5173\u95ed"),x.default.createElement(j,{value:"1"},"\u8fd0\u884c\u4e2d")))))),x.default.createElement("div",{style:{overflow:"hidden"}},x.default.createElement("div",{style:{float:"right",marginBottom:24}},x.default.createElement(b.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),x.default.createElement(b.default,{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e"),x.default.createElement("a",{style:{marginLeft:8},onClick:this.toggleForm},"\u6536\u8d77 ",x.default.createElement(v.default,{type:"up"})))))}renderForm(){this.state.expandForm;return this.renderSimpleForm()}render(){var e=this.props,t=e.news.data,a=e.loading,l=this.state,d=l.selectedRows,n=l.modalVisible,i=l.updateModalVisible,o=l.stepFormValues,f=x.default.createElement(u.default,{onClick:this.handleMenuClick,selectedKeys:[]},x.default.createElement(u.default.Item,{key:"remove"},"\u5220\u9664"),x.default.createElement(u.default.Item,{key:"approval"},"\u6279\u91cf\u5ba1\u6279")),c={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},m={handleUpdateModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return x.default.createElement(O.default,{title:"\u67e5\u8be2\u8868\u683c"},x.default.createElement(r.default,{bordered:!1},x.default.createElement("div",{className:A.default.tableList},x.default.createElement("div",{className:A.default.tableListOperator},x.default.createElement(U.default,{to:"/resource/detail"},x.default.createElement(b.default,{icon:"plus",type:"primary"},"\u65b0\u5efa\u83dc\u5355")),d.length>0&&x.default.createElement("span",null,x.default.createElement(b.default,null,"\u6279\u91cf\u64cd\u4f5c"),x.default.createElement(s.default,{overlay:f},x.default.createElement(b.default,null,"\u66f4\u591a\u64cd\u4f5c ",x.default.createElement(v.default,{type:"down"}))))),x.default.createElement(R.default,{selectedRows:d,loading:a,data:t,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),x.default.createElement(B,(0,p.default)({},c,{modalVisible:n,updateInfo:this.state.updateInfo})),o&&Object.keys(o).length?x.default.createElement(K,(0,p.default)({},m,{updateModalVisible:i,values:o})):null)}})||D)||D),X=P;t.default=X}}]);