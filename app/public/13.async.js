(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"1tHO":function(e,t,a){e.exports={card:"antd-pro-pages-resource-detail-card",heading:"antd-pro-pages-resource-detail-heading",steps:"antd-pro-pages-resource-detail-steps",errorIcon:"antd-pro-pages-resource-detail-errorIcon","ant-upload-select-picture-card":"antd-pro-pages-resource-detail-ant-upload-select-picture-card","ant-upload-text":"antd-pro-pages-resource-detail-ant-upload-text",errorPopover:"antd-pro-pages-resource-detail-errorPopover",errorListItem:"antd-pro-pages-resource-detail-errorListItem",errorField:"antd-pro-pages-resource-detail-errorField",editable:"antd-pro-pages-resource-detail-editable",advancedForm:"antd-pro-pages-resource-detail-advancedForm",optional:"antd-pro-pages-resource-detail-optional"}},XDbz:function(e,t,a){"use strict";var r=a("4Gf+"),l=a("GyWo");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("U7p0");var i=r(a("pXLU"));a("Ljnx");var s=r(a("EfNK"));a("K1xq");var d=r(a("lmRu"));a("Odsp");var n=r(a("0LJ2")),o=r(a("RSNA"));a("baa/");var u=r(a("6wzi")),p=r(a("BZ3U")),c=r(a("2gP4"));a("ZkGU");var f=r(a("zOAu"));a("1EyM");var m=r(a("VEhp"));a("Xe2/");var h=r(a("PRXz"));a("9RKC");var g=r(a("6RLy"));a("K5T9");var v,w,y,b=r(a("xn9m")),E=l(a("4G06")),L=a("LneV"),x=r(a("RBPO")),A=r(a("zHco")),C=(r(a("1tHO")),b.default.Item),P=(g.default.Option,h.default.RangePicker,m.default.TextArea),k=(v=(0,L.connect)(e=>{var t=e.news,a=e.loading;return{news:t,loading:a.models.news}}),w=b.default.create(),v(y=w(y=class extends E.PureComponent{constructor(){super(...arguments),this.handleSubmit=(e=>{var t=this.props,a=t.dispatch,r=t.form;e.preventDefault(),r.validateFieldsAndScroll((e,t)=>{var r=this.state.fileList,l=Array.isArray(r)&&r.map(e=>e.id||e.kid)||[];this.state.info.id&&(t.id=this.state.info.id),e||(t.images=l.join(","),a({type:"news/add",payload:t}).then(e=>{f.default[e.data?"success":"error"]("\u64cd\u4f5c\u6210\u529f"),setTimeout(()=>{x.default.push("/resource/index")},1500)}))})}),this.handleCancel=(()=>this.setState({previewVisible:!1})),this.handlePreview=(e=>{this.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}),this.state={previewVisible:!1,previewImage:"",fileList:[],info:{}}}handleChange(e){if("done"===e.file.status){var t=this.state.fileList,a=e.file.response.data;a=a.map(e=>{return e.kid=e.id,delete e.id,e}),Array.prototype.push.apply(t,a),console.log({fileList:t}),this.setState({fileList:t})}}componentDidMount(){var e=this;return(0,c.default)(p.default.mark(function t(){var a,r,l,i,s,d,n,o,u;return p.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.props,r=a.location,l=a.dispatch,i=r&&r.query&&r.query.id,i){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,l({type:"news/getList",payload:{id:i}});case 6:s=t.sent,d=s.payload&&Array.isArray(s.payload.list)&&s.payload.list[0],n=[],o=Array.isArray(d.imagesList)&&d.imagesList||[],u=d.imageIds&&d.imageIds.split(",")||[],o.forEach((e,t)=>{var a=e.split("/"),r=a[a.length-1];n.push({kid:u[t]||null,url:e,uid:-1*(t+1),name:r,status:"done"})}),e.setState({info:d,fileList:n});case 13:case"end":return t.stop()}},t,this)}))()}render(){var e=this.props.submitting,t=this.props.form,a=t.getFieldDecorator,r=(t.getFieldValue,{labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12},md:{span:10}}}),l={wrapperCol:{xs:{span:24,offset:0},sm:{span:10,offset:7}}},p=this.state,c=p.previewVisible,f=p.previewImage,h=p.fileList;console.log({fileList:h});var g=E.default.createElement("div",null,E.default.createElement(u.default,{type:"plus"}),E.default.createElement("div",{className:"ant-upload-text"},"\u4e0a\u4f20\u5c01\u9762"));return E.default.createElement(A.default,null,E.default.createElement(i.default,{bordered:!1},E.default.createElement(b.default,{onSubmit:this.handleSubmit,hideRequiredMark:!0,style:{marginTop:8}},E.default.createElement(C,(0,o.default)({},r,{label:"\u6807\u9898"}),a("title",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u9898"}],initialValue:this.state.info.title})(E.default.createElement(m.default,{placeholder:"\u8bf7\u8f93\u5165\u6807\u9898"}))),E.default.createElement(C,(0,o.default)({},r,{label:"\u5185\u5bb9"}),a("text",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5185\u5bb9"}],initialValue:this.state.info.text})(E.default.createElement(P,{style:{minHeight:32},placeholder:"\u8bf7\u8f93\u5165\u5185\u5bb9",rows:4}))),E.default.createElement(C,(0,o.default)({},r,{label:"\u5c01\u9762\u56fe\u7247"}),a("images",{initialValue:this.state.fileList})(E.default.createElement(n.default,{action:"https://www.taoyiwenhua.cn/upload/upload?uid=10000",listType:"picture-card",defaultFileList:[...h],onPreview:this.handlePreview,onChange:this.handleChange.bind(this)},g)),E.default.createElement(d.default,{visible:c,footer:null,onCancel:this.handleCancel},E.default.createElement("img",{alt:"example",style:{width:"100%"},src:f}))),E.default.createElement(C,(0,o.default)({},l,{style:{marginTop:32}}),E.default.createElement(s.default,{type:"primary",htmlType:"submit",loading:e},"\u63d0\u4ea4"),E.default.createElement(s.default,{style:{marginLeft:8}},"\u4fdd\u5b58")))))}})||y)||y),I=k;t.default=I}}]);