(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"2Rbm":function(e,t,a){"use strict";var l=a("4Gf+"),d=a("GyWo");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("U7p0");var r=l(a("pXLU"));a("t0lF");var s=l(a("kDCt"));a("baa/");var n=l(a("6wzi"));a("BrD1");var u=l(a("SpN2"));a("YvrW");var i=l(a("uG6z"));a("T7DU");var o=l(a("/72G"));a("X5VD");var c=l(a("bA53"));a("ZkGU");var f=l(a("zOAu"));a("I9VT");var m=l(a("OsYg"));a("02hr");var h=l(a("DLvC"));a("Ljnx");var p=l(a("EfNK"));a("Xe2/");var y=l(a("PRXz")),E=l(a("RSNA"));a("K1xq");var v=l(a("lmRu")),b=l(a("OjS7"));a("VfK5");var k=l(a("LcI5"));a("9RKC");var g=l(a("6RLy"));a("1EyM");var w=l(a("VEhp"));a("ZDDI");var V=l(a("XjAy"));a("K5T9");var L,F,C,S,x,M=l(a("xn9m")),D=d(a("4G06")),R=a("LneV"),I=(l(a("I9Uw")),l(a("CkN6"))),O=l(a("zHco")),A=l(a("L1s7")),U=M.default.Item,N=V.default.Step,T=w.default.TextArea,q=g.default.Option,j=k.default.Group,z=e=>Object.keys(e).map(t=>e[t]).join(","),G=["default","processing","success","error"],P=["\u672a\u5ba1\u6838","\u6709\u6548","\u8fc7\u671f"],B=M.default.create()(e=>{var t=e.modalVisible,a=e.form,l=e.handleAdd,d=e.handleModalVisible,r=e.info;r=r||{hotLevelMap:[]};var s=()=>{a.validateFields((e,t)=>{e||(a.resetFields(),r=(0,b.default)({},r,t),l(r))})},n=e=>{},u=r,i=u.hotLevelMap;return i=Array.isArray(i)&&i||[,30,20,10],console.log(JSON.stringify({info:r,hotLevelMap:i})),D.default.createElement(v.default,{destroyOnClose:!0,title:"\u65b0\u5efa\u89c4\u5219",visible:t,onOk:s,onCancel:()=>d()},D.default.createElement(U,{labelCol:{span:5},wrapperCol:{span:15},label:"\u7b49\u7ea7"},a.getFieldDecorator("hotLevel",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7b49\u7ea7"}]})(D.default.createElement(g.default,{defaultValue:r.hotLevel||0,style:{width:120},onChange:n},i.map((e,t)=>{if(e)return D.default.createElement(q,{value:t},e)})))))}),K=(L=M.default.create(),L(F=class extends D.PureComponent{constructor(e){super(e),this.handleNext=(e=>{var t=this.props,a=t.form,l=t.handleUpdate,d=this.state.formVals;a.validateFields((t,a)=>{if(!t){var r=(0,b.default)({},d,a);this.setState({formVals:r},()=>{e<2?this.forward():l(r)})}})}),this.backward=(()=>{var e=this.state.currentStep;this.setState({currentStep:e-1})}),this.forward=(()=>{var e=this.state.currentStep;this.setState({currentStep:e+1})}),this.renderContent=((e,t)=>{var a=this.props.form;return 1===e?[D.default.createElement(U,(0,E.default)({key:"target"},this.formLayout,{label:"\u76d1\u63a7\u5bf9\u8c61"}),a.getFieldDecorator("target",{initialValue:t.target})(D.default.createElement(g.default,{style:{width:"100%"}},D.default.createElement(q,{value:"0"},"\u8868\u4e00"),D.default.createElement(q,{value:"1"},"\u8868\u4e8c")))),D.default.createElement(U,(0,E.default)({key:"template"},this.formLayout,{label:"\u89c4\u5219\u6a21\u677f"}),a.getFieldDecorator("template",{initialValue:t.template})(D.default.createElement(g.default,{style:{width:"100%"}},D.default.createElement(q,{value:"0"},"\u89c4\u5219\u6a21\u677f\u4e00"),D.default.createElement(q,{value:"1"},"\u89c4\u5219\u6a21\u677f\u4e8c")))),D.default.createElement(U,(0,E.default)({key:"type"},this.formLayout,{label:"\u89c4\u5219\u7c7b\u578b"}),a.getFieldDecorator("type",{initialValue:t.type})(D.default.createElement(j,null,D.default.createElement(k.default,{value:"0"},"\u5f3a"),D.default.createElement(k.default,{value:"1"},"\u5f31"))))]:2===e?[D.default.createElement(U,(0,E.default)({key:"time"},this.formLayout,{label:"\u5f00\u59cb\u65f6\u95f4"}),a.getFieldDecorator("time",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5f00\u59cb\u65f6\u95f4\uff01"}]})(D.default.createElement(y.default,{style:{width:"100%"},showTime:!0,format:"YYYY-MM-DD HH:mm:ss",placeholder:"\u9009\u62e9\u5f00\u59cb\u65f6\u95f4"}))),D.default.createElement(U,(0,E.default)({key:"frequency"},this.formLayout,{label:"\u8c03\u5ea6\u5468\u671f"}),a.getFieldDecorator("frequency",{initialValue:t.frequency})(D.default.createElement(g.default,{style:{width:"100%"}},D.default.createElement(q,{value:"month"},"\u6708"),D.default.createElement(q,{value:"week"},"\u5468"))))]:[D.default.createElement(U,(0,E.default)({key:"name"},this.formLayout,{label:"\u89c4\u5219\u540d\u79f0"}),a.getFieldDecorator("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0\uff01"}],initialValue:t.name})(D.default.createElement(w.default,{placeholder:"\u8bf7\u8f93\u5165"}))),D.default.createElement(U,(0,E.default)({key:"desc"},this.formLayout,{label:"\u89c4\u5219\u63cf\u8ff0"}),a.getFieldDecorator("desc",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\u7684\u89c4\u5219\u63cf\u8ff0\uff01",min:5}],initialValue:t.desc})(D.default.createElement(T,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"})))]}),this.renderFooter=(e=>{var t=this.props.handleUpdateModalVisible;return 1===e?[D.default.createElement(p.default,{key:"back",style:{float:"left"},onClick:this.backward},"\u4e0a\u4e00\u6b65"),D.default.createElement(p.default,{key:"cancel",onClick:()=>t()},"\u53d6\u6d88"),D.default.createElement(p.default,{key:"forward",type:"primary",onClick:()=>this.handleNext(e)},"\u4e0b\u4e00\u6b65")]:2===e?[D.default.createElement(p.default,{key:"back",style:{float:"left"},onClick:this.backward},"\u4e0a\u4e00\u6b65"),D.default.createElement(p.default,{key:"cancel",onClick:()=>t()},"\u53d6\u6d88"),D.default.createElement(p.default,{key:"submit",type:"primary",onClick:()=>this.handleNext(e)},"\u5b8c\u6210")]:[D.default.createElement(p.default,{key:"cancel",onClick:()=>t()},"\u53d6\u6d88"),D.default.createElement(p.default,{key:"forward",type:"primary",onClick:()=>this.handleNext(e)},"\u4e0b\u4e00\u6b65")]}),this.state={formVals:{name:e.values.name,desc:e.values.desc,key:e.values.key,target:"0",template:"0",type:"1",time:"",frequency:"month"},currentStep:0},this.formLayout={labelCol:{span:7},wrapperCol:{span:13}}}render(){var e=this.props,t=e.updateModalVisible,a=e.handleUpdateModalVisible,l=this.state,d=l.currentStep,r=l.formVals;return D.default.createElement(v.default,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u89c4\u5219\u914d\u7f6e",visible:t,footer:this.renderFooter(d),onCancel:()=>a()},D.default.createElement(V.default,{style:{marginBottom:28},size:"small",current:d},D.default.createElement(N,{title:"\u57fa\u672c\u4fe1\u606f"}),D.default.createElement(N,{title:"\u914d\u7f6e\u89c4\u5219\u5c5e\u6027"}),D.default.createElement(N,{title:"\u8bbe\u5b9a\u8c03\u5ea6\u5468\u671f"})),this.renderContent(d,r))}})||F),Y=(C=(0,R.connect)(e=>{var t=e.collect,a=e.loading;return{collect:t,loading:a.models.collect}}),S=M.default.create(),C(x=S(x=class extends D.PureComponent{constructor(){super(...arguments),this.state={modalVisible:!1,info:{hotLevelMap:[]},updateModalVisible:!1,expandForm:!1,selectedRows:[],formValues:{},stepFormValues:{}},this.columns=[{title:"\u6807\u9898",dataIndex:"title"},{title:"\u63cf\u8ff0",width:360,dataIndex:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",sorter:!0,needTotal:!0},{title:"\u72b6\u6001",dataIndex:"flag",filters:[{text:P[0],value:0},{text:P[1],value:1},{text:P[2],value:2}],render(e){return D.default.createElement(h.default,{status:G[e],text:P[e]})}},{title:"\u5173\u6ce8\u6570",dataIndex:"hotLevel",sorter:!0,render:e=>D.default.createElement("span",null,e)},{title:"\u7528\u6237",dataIndex:"userName",render:e=>D.default.createElement("span",null,e)},{title:"\u64cd\u4f5c",render:(e,t)=>{var a=1==t.mark,l="";return a||(l=D.default.createElement(D.Fragment,null,D.default.createElement(m.default,{type:"vertical"}),D.default.createElement("a",{onClick:()=>this.handleModalVisible(!0,t)},"\u8c03\u6574\u5173\u6ce8\u6570"))),D.default.createElement(D.Fragment,null,D.default.createElement("a",{onClick:()=>this.handlePass(t)},["\u5ba1\u6838\u901a\u8fc7","\u5ba1\u6838\u4e0d\u901a\u8fc7"][t.mark]),D.default.createElement(m.default,{type:"vertical"}),D.default.createElement("a",{onClick:()=>this.handleDel(t)},"\u5220\u9664"),l)}}],this.handleStandardTableChange=((e,t,a)=>{var l=this.props.dispatch,d=this.state.formValues,r=Object.keys(t).reduce((e,a)=>{var l=(0,b.default)({},e);return l[a]=z(t[a]),l},{}),s=(0,b.default)({currentPage:e.current,pageSize:e.pageSize},d,r);a.field&&(s.sorter=`${a.field}_${a.order}`),l({type:"collect/getList",payload:s})}),this.handleFormReset=(()=>{var e=this.props,t=e.form,a=e.dispatch;t.resetFields(),this.setState({formValues:{}}),a({type:"collect/getList",payload:{}})}),this.toggleForm=(()=>{var e=this.state.expandForm;this.setState({expandForm:!e})}),this.handleMenuClick=(e=>{var t=this.props.dispatch,a=this.state.selectedRows;if(a)switch(e.key){case"remove":t({type:"rule/remove",payload:{key:a.map(e=>e.key)},callback:()=>{this.setState({selectedRows:[]})}});break;default:break}}),this.handleSelectRows=(e=>{this.setState({selectedRows:e})}),this.handleSearch=(e=>{e.preventDefault();var t=this.props,a=t.dispatch,l=t.form;l.validateFields((e,t)=>{if(!e){var l=(0,b.default)({},t,{updatedAt:t.updatedAt&&t.updatedAt.valueOf()});this.setState({formValues:l}),a({type:"collect/getList",payload:{status:parseInt(t.status)}})}})}),this.handleModalVisible=((e,t)=>{this.setState({modalVisible:!!e,info:t})}),this.handleUpdateModalVisible=((e,t)=>{this.setState({updateModalVisible:!!e,stepFormValues:t||{}})}),this.handleAdd=(e=>{var t=this.props.dispatch;t({type:"collect/check",payload:{collectionId:e.id,hotLevel:e.hotLevel}}).then(e=>{f.default.success("\u5ba1\u6838\u6210\u529f"),this.reload()}).catch(e=>f.default.error("\u5ba1\u6838\u5931\u8d25"))}),this.handleUpdate=(e=>{var t=this.props.dispatch;t({type:"rule/update",payload:{name:e.name,desc:e.desc,key:e.key}}),f.default.success("\u914d\u7f6e\u6210\u529f"),this.handleUpdateModalVisible()})}handleDel(e){var t=e.id,a=this.props.dispatch;a({type:"collect/del",payload:{collectionId:t}}).then(e=>{f.default.success("\u5220\u9664\u6210\u529f"),this.reload()}).catch(e=>f.default.error("\u5220\u9664\u5931\u8d25"))}reload(){var e=this.props.dispatch;e({type:"collect/getList",payload:{}})}handlePass(e){var t=this.props.dispatch;t({type:"collect/check",payload:{collectionId:e.id}}).then(e=>{f.default.success("\u5ba1\u6838\u6210\u529f"),this.reload()}).catch(e=>f.default.error("\u5ba1\u6838\u5931\u8d25"))}componentDidMount(){var e=this.props.dispatch;e({type:"collect/getList"})}renderSimpleForm(){var e=this.props.form.getFieldDecorator;return D.default.createElement(M.default,{onSubmit:this.handleSearch,layout:"inline"},D.default.createElement(o.default,{gutter:{md:8,lg:24,xl:48}},D.default.createElement(c.default,{md:8,sm:24},D.default.createElement(U,{label:"\u72b6\u6001"},e("status")(D.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},D.default.createElement(q,{value:"0"},"\u672a\u5ba1\u6838"),D.default.createElement(q,{value:"1"},"\u5ba1\u6838"))))),D.default.createElement(c.default,{md:6,sm:24},D.default.createElement("span",{className:A.default.submitButtons},D.default.createElement(p.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),D.default.createElement(p.default,{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e")))))}renderAdvancedForm(){var e=this.props.form.getFieldDecorator;return D.default.createElement(M.default,{onSubmit:this.handleSearch,layout:"inline"},D.default.createElement(o.default,{gutter:{md:8,lg:24,xl:48}},D.default.createElement(c.default,{md:8,sm:24},D.default.createElement(U,{label:"\u89c4\u5219\u540d\u79f0"},e("name")(D.default.createElement(w.default,{placeholder:"\u8bf7\u8f93\u5165"})))),D.default.createElement(c.default,{md:8,sm:24},D.default.createElement(U,{label:"\u4f7f\u7528\u72b6\u6001"},e("status")(D.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},D.default.createElement(q,{value:"0"},"\u5173\u95ed"),D.default.createElement(q,{value:"1"},"\u8fd0\u884c\u4e2d"))))),D.default.createElement(c.default,{md:8,sm:24},D.default.createElement(U,{label:"\u8c03\u7528\u6b21\u6570"},e("number")(D.default.createElement(i.default,{style:{width:"100%"}}))))),D.default.createElement(o.default,{gutter:{md:8,lg:24,xl:48}},D.default.createElement(c.default,{md:8,sm:24},D.default.createElement(U,{label:"\u66f4\u65b0\u65e5\u671f"},e("date")(D.default.createElement(y.default,{style:{width:"100%"},placeholder:"\u8bf7\u8f93\u5165\u66f4\u65b0\u65e5\u671f"})))),D.default.createElement(c.default,{md:8,sm:24},D.default.createElement(U,{label:"\u4f7f\u7528\u72b6\u6001"},e("status3")(D.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},D.default.createElement(q,{value:"0"},"\u5173\u95ed"),D.default.createElement(q,{value:"1"},"\u8fd0\u884c\u4e2d"))))),D.default.createElement(c.default,{md:8,sm:24},D.default.createElement(U,{label:"\u4f7f\u7528\u72b6\u6001"},e("status4")(D.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},D.default.createElement(q,{value:"0"},"\u5173\u95ed"),D.default.createElement(q,{value:"1"},"\u8fd0\u884c\u4e2d")))))),D.default.createElement("div",{style:{overflow:"hidden"}},D.default.createElement("div",{style:{float:"right",marginBottom:24}},D.default.createElement(p.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),D.default.createElement(p.default,{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e"))))}renderForm(){this.state.expandForm;return this.renderSimpleForm()}render(){var e=this.props,t=e.collect.data,a=e.loading,l=this.state,d=l.selectedRows,i=l.modalVisible,o=l.updateModalVisible,c=l.stepFormValues,f=l.info,m=D.default.createElement(u.default,{onClick:this.handleMenuClick,selectedKeys:[]},D.default.createElement(u.default.Item,{key:"remove"},"\u5220\u9664"),D.default.createElement(u.default.Item,{key:"approval"},"\u6279\u91cf\u5ba1\u6279")),h={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},y={handleUpdateModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return D.default.createElement(O.default,{title:"\u67e5\u8be2\u8868\u683c"},D.default.createElement(r.default,{bordered:!1},D.default.createElement("div",{className:A.default.tableList},D.default.createElement("div",{className:A.default.tableListForm},this.renderForm()),D.default.createElement("div",{className:A.default.tableListOperator},D.default.createElement(p.default,{icon:"plus",type:"primary",onClick:()=>this.handleModalVisible(!0)},"\u65b0\u5efa"),d.length>0&&D.default.createElement("span",null,D.default.createElement(p.default,null,"\u6279\u91cf\u64cd\u4f5c"),D.default.createElement(s.default,{overlay:m},D.default.createElement(p.default,null,"\u66f4\u591a\u64cd\u4f5c ",D.default.createElement(n.default,{type:"down"}))))),D.default.createElement(I.default,{selectedRows:d,loading:a,data:t,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),D.default.createElement(B,(0,E.default)({},h,{modalVisible:i,info:f})),c&&Object.keys(c).length?D.default.createElement(K,(0,E.default)({},y,{updateModalVisible:o,values:c})):null)}})||x)||x),X=Y;t.default=X},L1s7:function(e,t,a){e.exports={tableList:"antd-pro-pages-content-list-tableList",tableListOperator:"antd-pro-pages-content-list-tableListOperator",tableListForm:"antd-pro-pages-content-list-tableListForm",submitButtons:"antd-pro-pages-content-list-submitButtons"}}}]);