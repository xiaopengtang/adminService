(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{COx8:function(e,t,a){"use strict";var l=a("4Gf+"),d=a("GyWo");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("U7p0");var r=l(a("pXLU"));a("t0lF");var s=l(a("kDCt"));a("BrD1");var u=l(a("SpN2"));a("baa/");var n=l(a("6wzi"));a("YvrW");var i=l(a("uG6z"));a("T7DU");var o=l(a("/72G"));a("X5VD");var f=l(a("bA53"));a("ZkGU");var c=l(a("zOAu"));a("I9VT");var m=l(a("OsYg"));a("Ljnx");var p=l(a("EfNK"));a("Xe2/");var h=l(a("PRXz")),y=l(a("RSNA")),E=l(a("OjS7"));a("K1xq");var v=l(a("lmRu"));a("VfK5");var b=l(a("LcI5"));a("9RKC");var g=l(a("6RLy"));a("1EyM");var k=l(a("VEhp"));a("ZDDI");var V=l(a("XjAy"));a("K5T9");var w,S,C,F,L,x=l(a("xn9m")),M=d(a("4G06")),D=a("LneV"),I=(l(a("I9Uw")),a("HZnN"),l(a("CkN6"))),R=l(a("zHco")),O=l(a("fpe4")),U=x.default.Item,A=V.default.Step,N=k.default.TextArea,T=g.default.Option,q=b.default.Group,j=e=>Object.keys(e).map(t=>e[t]).join(","),z=x.default.create()(e=>{var t=e.modalVisible,a=e.form,l=e.handleAdd,d=e.handleModalVisible,r=e.updateInfo,s=()=>{a.validateFields((e,t)=>{e||(r&&(t.id=r.id),a.resetFields(),l(t))})};return r=r||{},M.default.createElement(v.default,{destroyOnClose:!0,title:r.id?"\u4fee\u6539\u914d\u7f6e":"\u65b0\u5efa\u914d\u7f6e",visible:t,onOk:s,onCancel:()=>d()},M.default.createElement(U,{labelCol:{span:5},wrapperCol:{span:15},label:"\u914d\u7f6e\u540d"},a.getFieldDecorator("keyStr",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u914d\u7f6e\u540d"}],initialValue:r.keyStr})(M.default.createElement(k.default,{placeholder:"\u8bf7\u8f93\u5165"}))),M.default.createElement(U,{labelCol:{span:5},wrapperCol:{span:15},label:"\u914d\u7f6e\u503c"},a.getFieldDecorator("valueStr",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u914d\u7f6e\u503c"}],initialValue:r.valueStr})(M.default.createElement(k.default,{placeholder:"\u8bf7\u8f93\u5165"}))))}),G=(w=x.default.create(),w(S=class extends M.PureComponent{constructor(e){super(e),this.handleNext=(e=>{var t=this.props,a=t.form,l=t.handleUpdate,d=this.state.formVals;a.validateFields((t,a)=>{if(!t){var r=(0,E.default)({},d,a);this.setState({formVals:r},()=>{e<2?this.forward():l(r)})}})}),this.backward=(()=>{var e=this.state.currentStep;this.setState({currentStep:e-1})}),this.forward=(()=>{var e=this.state.currentStep;this.setState({currentStep:e+1})}),this.renderContent=((e,t)=>{var a=this.props.form;return 1===e?[M.default.createElement(U,(0,y.default)({key:"target"},this.formLayout,{label:"\u76d1\u63a7\u5bf9\u8c61"}),a.getFieldDecorator("target",{initialValue:t.target})(M.default.createElement(g.default,{style:{width:"100%"}},M.default.createElement(T,{value:"0"},"\u8868\u4e00"),M.default.createElement(T,{value:"1"},"\u8868\u4e8c")))),M.default.createElement(U,(0,y.default)({key:"template"},this.formLayout,{label:"\u89c4\u5219\u6a21\u677f"}),a.getFieldDecorator("template",{initialValue:t.template})(M.default.createElement(g.default,{style:{width:"100%"}},M.default.createElement(T,{value:"0"},"\u89c4\u5219\u6a21\u677f\u4e00"),M.default.createElement(T,{value:"1"},"\u89c4\u5219\u6a21\u677f\u4e8c")))),M.default.createElement(U,(0,y.default)({key:"type"},this.formLayout,{label:"\u89c4\u5219\u7c7b\u578b"}),a.getFieldDecorator("type",{initialValue:t.type})(M.default.createElement(q,null,M.default.createElement(b.default,{value:"0"},"\u5f3a"),M.default.createElement(b.default,{value:"1"},"\u5f31"))))]:2===e?[M.default.createElement(U,(0,y.default)({key:"time"},this.formLayout,{label:"\u5f00\u59cb\u65f6\u95f4"}),a.getFieldDecorator("time",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5f00\u59cb\u65f6\u95f4\uff01"}]})(M.default.createElement(h.default,{style:{width:"100%"},showTime:!0,format:"YYYY-MM-DD HH:mm:ss",placeholder:"\u9009\u62e9\u5f00\u59cb\u65f6\u95f4"}))),M.default.createElement(U,(0,y.default)({key:"frequency"},this.formLayout,{label:"\u8c03\u5ea6\u5468\u671f"}),a.getFieldDecorator("frequency",{initialValue:t.frequency})(M.default.createElement(g.default,{style:{width:"100%"}},M.default.createElement(T,{value:"month"},"\u6708"),M.default.createElement(T,{value:"week"},"\u5468"))))]:[M.default.createElement(U,(0,y.default)({key:"name"},this.formLayout,{label:"\u89c4\u5219\u540d\u79f0"}),a.getFieldDecorator("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0\uff01"}],initialValue:t.name})(M.default.createElement(k.default,{placeholder:"\u8bf7\u8f93\u5165"}))),M.default.createElement(U,(0,y.default)({key:"desc"},this.formLayout,{label:"\u89c4\u5219\u63cf\u8ff0"}),a.getFieldDecorator("desc",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26\u7684\u89c4\u5219\u63cf\u8ff0\uff01",min:5}],initialValue:t.desc})(M.default.createElement(N,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c11\u4e94\u4e2a\u5b57\u7b26"})))]}),this.renderFooter=(e=>{var t=this.props.handleUpdateModalVisible;return 1===e?[M.default.createElement(p.default,{key:"back",style:{float:"left"},onClick:this.backward},"\u4e0a\u4e00\u6b65"),M.default.createElement(p.default,{key:"cancel",onClick:()=>t()},"\u53d6\u6d88"),M.default.createElement(p.default,{key:"forward",type:"primary",onClick:()=>this.handleNext(e)},"\u4e0b\u4e00\u6b65")]:2===e?[M.default.createElement(p.default,{key:"back",style:{float:"left"},onClick:this.backward},"\u4e0a\u4e00\u6b65"),M.default.createElement(p.default,{key:"cancel",onClick:()=>t()},"\u53d6\u6d88"),M.default.createElement(p.default,{key:"submit",type:"primary",onClick:()=>this.handleNext(e)},"\u5b8c\u6210")]:[M.default.createElement(p.default,{key:"cancel",onClick:()=>t()},"\u53d6\u6d88"),M.default.createElement(p.default,{key:"forward",type:"primary",onClick:()=>this.handleNext(e)},"\u4e0b\u4e00\u6b65")]}),this.state={formVals:{name:e.values.name,desc:e.values.desc,key:e.values.key,target:"0",template:"0",type:"1",time:"",frequency:"month"},updateInfo:{},currentStep:0},this.formLayout={labelCol:{span:7},wrapperCol:{span:13}}}render(){var e=this.props,t=e.updateModalVisible,a=e.handleUpdateModalVisible,l=this.state,d=l.currentStep,r=l.formVals;return M.default.createElement(v.default,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u89c4\u5219\u914d\u7f6e",visible:t,footer:this.renderFooter(d),onCancel:()=>a()},M.default.createElement(V.default,{style:{marginBottom:28},size:"small",current:d},M.default.createElement(A,{title:"\u57fa\u672c\u4fe1\u606f"}),M.default.createElement(A,{title:"\u914d\u7f6e\u89c4\u5219\u5c5e\u6027"}),M.default.createElement(A,{title:"\u8bbe\u5b9a\u8c03\u5ea6\u5468\u671f"})),this.renderContent(d,r))}})||S),B=(C=(0,D.connect)(e=>{var t=e.config,a=e.loading;return{config:t,loading:a.models.config}}),F=x.default.create(),C(L=F(L=class extends M.PureComponent{constructor(){super(...arguments),this.state={modalVisible:!1,updateModalVisible:!1,expandForm:!1,selectedRows:[],formValues:{},stepFormValues:{}},this.columns=[{title:"ID",dataIndex:"id"},{title:"\u540d\u79f0",dataIndex:"keyStr"},{title:"\u503c",dataIndex:"valueStr"},{title:"\u6dfb\u52a0\u65f6\u95f4",dataIndex:"updateTime",sorter:!0,needTotal:!0},{title:"\u64cd\u4f5c",render:(e,t)=>M.default.createElement(M.Fragment,null,M.default.createElement("a",{onClick:()=>this.handleDelModalVisible(!0,t)},"\u5220\u9664"),M.default.createElement(m.default,{type:"vertical"}),M.default.createElement("a",{onClick:()=>this.handleUpdateModalVisible(t)},"\u4fee\u6539"))}],this.handleStandardTableChange=((e,t,a)=>{var l=this.props.dispatch,d=this.state.formValues,r=Object.keys(t).reduce((e,a)=>{var l=(0,E.default)({},e);return l[a]=j(t[a]),l},{}),s=(0,E.default)({currentPage:e.current,pageSize:e.pageSize},d,r);a.field&&(s.sorter=`${a.field}_${a.order}`),l({type:"config/getList",payload:s})}),this.handleFormReset=(()=>{var e=this.props,t=e.form,a=e.dispatch;t.resetFields(),this.setState({formValues:{}}),a({type:"config/getList",payload:{}})}),this.toggleForm=(()=>{var e=this.state.expandForm;this.setState({expandForm:!e})}),this.handleMenuClick=(e=>{var t=this.props.dispatch,a=this.state.selectedRows;if(a)switch(e.key){case"remove":t({type:"rule/remove",payload:{key:a.map(e=>e.key)},callback:()=>{this.setState({selectedRows:[]})}});break;default:break}}),this.handleSelectRows=(e=>{this.setState({selectedRows:e})}),this.handleSearch=(e=>{e.preventDefault();var t=this.props,a=t.dispatch,l=t.form;l.validateFields((e,t)=>{if(!e){var l=(0,E.default)({},t,{updatedAt:t.updatedAt&&t.updatedAt.valueOf()});this.setState({formValues:l}),a({type:"config/getList",payload:l})}})}),this.handleModalVisible=(e=>{this.setState({modalVisible:!!e,updateInfo:null})}),this.handleDelModalVisible=((e,t)=>{var a=this.props.dispatch;a({type:"config/del",payload:{id:t.id}}).then(e=>{c.default.success("\u5220\u9664\u6210\u529f"),this.reload()}).catch(e=>c.default.error("\u5220\u9664\u5931\u8d25"))}),this.handleAdd=(e=>{var t=this.props.dispatch;t({type:e.id?"config/update":"config/add",payload:e}).then(e=>{c.default.success("\u64cd\u4f5c\u6210\u529f"),this.reload(),this.handleModalVisible()}).catch(e=>c.default.error("\u64cd\u4f5c\u5931\u8d25"))}),this.handleUpdate=(e=>{var t=this.props.dispatch;t({type:"rule/update",payload:{name:e.name,desc:e.desc,key:e.key}}),c.default.success("\u914d\u7f6e\u6210\u529f"),this.handleUpdateModalVisible()})}componentDidMount(){var e=this.props.dispatch;e({type:"config/getList"})}handleUpdateModalVisible(e){this.setState({modalVisible:!0,updateInfo:e})}reload(){var e=this.props.dispatch;e({type:"config/getList",payload:{}})}renderSimpleForm(){var e=this.props.form.getFieldDecorator;return M.default.createElement(x.default,{onSubmit:this.handleSearch,layout:"inline"},M.default.createElement(o.default,{gutter:{md:8,lg:24,xl:48}},M.default.createElement(f.default,{md:8,sm:24},M.default.createElement(U,{label:"\u6807\u9898"},e("name")(M.default.createElement(k.default,{placeholder:"\u8bf7\u8f93\u5165"})))),M.default.createElement(f.default,{md:8,sm:24},M.default.createElement(U,{label:"\u72b6\u6001"},e("status")(M.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},M.default.createElement(T,{value:"0"},"\u5173\u95ed"),M.default.createElement(T,{value:"1"},"\u8fd0\u884c\u4e2d"))))),M.default.createElement(f.default,{md:6,sm:24},M.default.createElement("span",{className:O.default.submitButtons},M.default.createElement(p.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),M.default.createElement(p.default,{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e")))))}renderAdvancedForm(){var e=this.props.form.getFieldDecorator;return M.default.createElement(x.default,{onSubmit:this.handleSearch,layout:"inline"},M.default.createElement(o.default,{gutter:{md:8,lg:24,xl:48}},M.default.createElement(f.default,{md:8,sm:24},M.default.createElement(U,{label:"\u89c4\u5219\u540d\u79f0"},e("name")(M.default.createElement(k.default,{placeholder:"\u8bf7\u8f93\u5165"})))),M.default.createElement(f.default,{md:8,sm:24},M.default.createElement(U,{label:"\u4f7f\u7528\u72b6\u6001"},e("status")(M.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},M.default.createElement(T,{value:"0"},"\u5173\u95ed"),M.default.createElement(T,{value:"1"},"\u8fd0\u884c\u4e2d"))))),M.default.createElement(f.default,{md:8,sm:24},M.default.createElement(U,{label:"\u8c03\u7528\u6b21\u6570"},e("number")(M.default.createElement(i.default,{style:{width:"100%"}}))))),M.default.createElement(o.default,{gutter:{md:8,lg:24,xl:48}},M.default.createElement(f.default,{md:8,sm:24},M.default.createElement(U,{label:"\u66f4\u65b0\u65e5\u671f"},e("date")(M.default.createElement(h.default,{style:{width:"100%"},placeholder:"\u8bf7\u8f93\u5165\u66f4\u65b0\u65e5\u671f"})))),M.default.createElement(f.default,{md:8,sm:24},M.default.createElement(U,{label:"\u4f7f\u7528\u72b6\u6001"},e("status3")(M.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},M.default.createElement(T,{value:"0"},"\u5173\u95ed"),M.default.createElement(T,{value:"1"},"\u8fd0\u884c\u4e2d"))))),M.default.createElement(f.default,{md:8,sm:24},M.default.createElement(U,{label:"\u4f7f\u7528\u72b6\u6001"},e("status4")(M.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"}},M.default.createElement(T,{value:"0"},"\u5173\u95ed"),M.default.createElement(T,{value:"1"},"\u8fd0\u884c\u4e2d")))))),M.default.createElement("div",{style:{overflow:"hidden"}},M.default.createElement("div",{style:{float:"right",marginBottom:24}},M.default.createElement(p.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),M.default.createElement(p.default,{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e"),M.default.createElement("a",{style:{marginLeft:8},onClick:this.toggleForm},"\u6536\u8d77 ",M.default.createElement(n.default,{type:"up"})))))}renderForm(){this.state.expandForm;return this.renderSimpleForm()}render(){var e=this.props,t=e.config.data,a=e.loading,l=this.state,d=l.selectedRows,i=l.modalVisible,o=l.updateModalVisible,f=l.stepFormValues,c=M.default.createElement(u.default,{onClick:this.handleMenuClick,selectedKeys:[]},M.default.createElement(u.default.Item,{key:"remove"},"\u5220\u9664"),M.default.createElement(u.default.Item,{key:"approval"},"\u6279\u91cf\u5ba1\u6279")),m={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},h={handleUpdateModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return M.default.createElement(R.default,{title:"\u67e5\u8be2\u8868\u683c"},M.default.createElement(r.default,{bordered:!1},M.default.createElement("div",{className:O.default.tableList},M.default.createElement("div",{className:O.default.tableListOperator},M.default.createElement(p.default,{icon:"plus",type:"primary",onClick:()=>this.handleModalVisible(!0)},"\u65b0\u5efa"),d.length>0&&M.default.createElement("span",null,M.default.createElement(p.default,null,"\u6279\u91cf\u64cd\u4f5c"),M.default.createElement(s.default,{overlay:c},M.default.createElement(p.default,null,"\u66f4\u591a\u64cd\u4f5c ",M.default.createElement(n.default,{type:"down"}))))),M.default.createElement(I.default,{selectedRows:d,loading:a,data:t,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),M.default.createElement(z,(0,y.default)({},m,{modalVisible:i,updateInfo:this.state.updateInfo})),f&&Object.keys(f).length?M.default.createElement(G,(0,y.default)({},h,{updateModalVisible:o,values:f})):null)}})||L)||L),K=B;t.default=K},fpe4:function(e,t,a){e.exports={tableList:"antd-pro-pages-config-list-tableList",tableListOperator:"antd-pro-pages-config-list-tableListOperator",tableListForm:"antd-pro-pages-config-list-tableListForm",submitButtons:"antd-pro-pages-config-list-submitButtons"}}}]);